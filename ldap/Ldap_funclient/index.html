<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Ldap_funclient (ldap.Ldap_funclient)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">ldap</a> &#x00BB; Ldap_funclient</nav><h1>Module <code>Ldap_funclient</code></h1><p>a functional ldap client interface</p></header><dl><dt class="spec type" id="type-msgid"><a href="#type-msgid" class="anchor"></a><code><span class="keyword">type</span> msgid</code></dt><dt class="spec type" id="type-conn"><a href="#type-conn" class="anchor"></a><code><span class="keyword">type</span> conn</code></dt><dt class="spec type" id="type-modattr"><a href="#type-modattr" class="anchor"></a><code><span class="keyword">type</span> modattr</code><code> = <a href="../Ldap_types/index.html#type-modify_optype">Ldap_types.modify_optype</a> * string * <span>string list</span></code></dt><dt class="spec type" id="type-result"><a href="#type-result" class="anchor"></a><code><span class="keyword">type</span> result</code><code> = <span><a href="../Ldap_types/index.html#type-search_result_entry">Ldap_types.search_result_entry</a> list</span></code></dt><dt class="spec type" id="type-entry"><a href="#type-entry" class="anchor"></a><code><span class="keyword">type</span> entry</code><code> = <a href="../Ldap_types/index.html#type-search_result_entry">Ldap_types.search_result_entry</a></code></dt><dt class="spec type" id="type-authmethod"><a href="#type-authmethod" class="anchor"></a><code><span class="keyword">type</span> authmethod</code> = <code>[ </code><table class="variant"><tr id="type-authmethod.SIMPLE" class="anchored"><td class="def constructor"><a href="#type-authmethod.SIMPLE" class="anchor"></a><code>| </code><code>`SIMPLE</code></td></tr><tr id="type-authmethod.SASL" class="anchored"><td class="def constructor"><a href="#type-authmethod.SASL" class="anchor"></a><code>| </code><code>`SASL</code></td></tr></table><code> ]</code></dt><dt class="spec type" id="type-search_result"><a href="#type-search_result" class="anchor"></a><code><span class="keyword">type</span> search_result</code> = <code>[ </code><table class="variant"><tr id="type-search_result.Entry" class="anchored"><td class="def constructor"><a href="#type-search_result.Entry" class="anchor"></a><code>| </code><code>`Entry <span class="keyword">of</span> <a href="index.html#type-entry">entry</a></code></td></tr><tr id="type-search_result.Referral" class="anchored"><td class="def constructor"><a href="#type-search_result.Referral" class="anchor"></a><code>| </code><code>`Referral <span class="keyword">of</span> <span>string list</span></code></td></tr><tr id="type-search_result.Success" class="anchored"><td class="def constructor"><a href="#type-search_result.Success" class="anchor"></a><code>| </code><code>`Success <span class="keyword">of</span> <span><a href="../Ldap_types/index.html#type-ldap_controls">Ldap_types.ldap_controls</a> option</span></code></td></tr></table><code> ]</code></dt><dt class="spec type" id="type-page_control"><a href="#type-page_control" class="anchor"></a><code><span class="keyword">type</span> page_control</code> = <code>[ </code><table class="variant"><tr id="type-page_control.Noctrl" class="anchored"><td class="def constructor"><a href="#type-page_control.Noctrl" class="anchor"></a><code>| </code><code>`Noctrl</code></td></tr><tr id="type-page_control.Initctrl" class="anchored"><td class="def constructor"><a href="#type-page_control.Initctrl" class="anchor"></a><code>| </code><code>`Initctrl <span class="keyword">of</span> int</code></td></tr><tr id="type-page_control.Subctrl" class="anchored"><td class="def constructor"><a href="#type-page_control.Subctrl" class="anchor"></a><code>| </code><code>`Subctrl <span class="keyword">of</span> int * string</code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-init"><a href="#val-init" class="anchor"></a><code><span class="keyword">val</span> init : <span>?&#8288;connect_timeout:int</span> <span>&#45;&gt;</span> <span>?&#8288;version:int</span> <span>&#45;&gt;</span> <span>string list</span> <span>&#45;&gt;</span> <a href="index.html#type-conn">conn</a></code></dt><dd><p>Initializes the conn data structure, and opens a connection to the server. init <code>[&quot;ldap://rrhost.example.com/&quot;;&quot;ldap://backup.example.com:1389&quot;]</code>. init is round robin dns aware, if dns returns multiple mappings it will try each one before finially failing. It also takes a list of hostnames, so you can specify backup servers to try. SSL and TLS are supported if selected at compile time.</p><dl><dt>parameter version</dt><dd><p>the protocol version to use to connect, default is version 3. And actually, version 2 will probably not work correctly without some tweaking.</p></dd></dl><dl><dt>raises LDAP_Failure</dt><dd><p>any failure to connect to the server will result in LDAP_Failure with the result_code set to `LOCAL_ERROR.</p></dd></dl><dl><dt>raises Failure</dt><dd><p>May raise Failure &quot;int_of_string&quot; if you pass it a malformed url. May also raise various lexer errors under the same conditions.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-unbind"><a href="#val-unbind" class="anchor"></a><code><span class="keyword">val</span> unbind : <a href="index.html#type-conn">conn</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>close the connection to the server. You may not use the conn after you have unbound, if you do you will get an exception.</p></dd></dl><dl><dt class="spec value" id="val-bind_s"><a href="#val-bind_s" class="anchor"></a><code><span class="keyword">val</span> bind_s : <span>?&#8288;who:string</span> <span>&#45;&gt;</span> <span>?&#8288;cred:string</span> <span>&#45;&gt;</span> <span>?&#8288;auth_method:<span>[&gt; `SIMPLE ]</span></span> <span>&#45;&gt;</span> <a href="index.html#type-conn">conn</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>authenticatite to the server. In this version only simple binds are supported, however the ldap_protocol.ml module DOES implement sasl binds. It would be fairly easy to support them here. We eventually will.</p><dl><dt>parameter who</dt><dd><p>the dn to bind as</p></dd></dl><dl><dt>parameter cred</dt><dd><p>the credentials to authenticate with. For `SIMPLE binds this is a password, but for `SASL binds it can be nearly anything. Perhaps a hash of the thumb print of your first born is sufficent.</p></dd></dl><dl><dt>parameter auth_method</dt><dd><p>either `SIMPLE (the default) or `SASL</p></dd></dl><dl><dt>raises LDAP_Failure</dt><dd><p>for bind errors such as `INVALID_CREDENTIALS</p></dd></dl><dl><dt>raises Decoding_error</dt><dd><p>for decoder errors (unlikely, probably a bug)</p></dd></dl><dl><dt>raises Encoding_error</dt><dd><p>for encoder errors (unlikely, probably a bug)</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-search"><a href="#val-search" class="anchor"></a><code><span class="keyword">val</span> search : <span>?&#8288;base:string</span> <span>&#45;&gt;</span> <span>?&#8288;scope:<a href="../Ldap_types/index.html#type-search_scope">Ldap_types.search_scope</a></span> <span>&#45;&gt;</span> <span>?&#8288;aliasderef:<a href="../Ldap_types/index.html#type-alias_deref">Ldap_types.alias_deref</a></span> <span>&#45;&gt;</span> <span>?&#8288;sizelimit:int32</span> <span>&#45;&gt;</span> <span>?&#8288;timelimit:int32</span> <span>&#45;&gt;</span> <span>?&#8288;attrs:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;attrsonly:bool</span> <span>&#45;&gt;</span> <span>?&#8288;page_control:<a href="index.html#type-page_control">page_control</a></span> <span>&#45;&gt;</span> <a href="index.html#type-conn">conn</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-msgid">msgid</a></code></dt><dd><p>Search for the given entry with the specified base node and search scope, optionally limiting the returned attributes to those listed in 'attrs'. aliasderef sets the server's alias dereferencing policy, sizelimit is the number of entries to return, timelimit is the number of seconds to allow the search to run for, attrsonly tells the server not to return the values. This is the asyncronus version of search (it does not block) you will need to call the get_search_entry function below to actually get any data back. This function will return a msgid which you must use when you call get_search_entry.</p><dl><dt>parameter base</dt><dd><p>The dn of the object in the tree to use as the base object, the search will only cover children of this object, and will be further governed by scope.</p></dd></dl><dl><dt>parameter scope</dt><dd><p>The depth in the tree to look for the requested object. There are three possible values, `BASE, `ONELEVEL, and `SUBTREE. `BASE means to only search the base object, the search will return exactly 1 or 0 objects. `ONELEVEL means to search one level under the base, only immediate children of the base object will be considered. `SUBTREE means to search the entire tree under the base object.</p></dd></dl><dl><dt>parameter aliasderef</dt><dd><p>Controls when aliases are dereferenced.</p></dd></dl><dl><dt>parameter sizelimit</dt><dd><p>The maximum number of objects to return</p></dd></dl><dl><dt>parameter timelimit</dt><dd><p>The maximum time, in seconds, that the search will be allowed to run before terminateing.</p></dd></dl><dl><dt>parameter attrs</dt><dd><p>The list of attribute types (names) to include <code>[]</code> (the default) means all.</p></dd></dl><dl><dt>parameter attrsonly</dt><dd><p>return only attribute types (names), not any of the values</p></dd></dl><dl><dt>raises LDAP_Failure</dt><dd><p>for immediate errors (bad filter, etc)</p></dd></dl><dl><dt>raises Decoding_error</dt><dd><p>for decoder errors (unlikely, probably a bug)</p></dd></dl><dl><dt>raises Encoding_error</dt><dd><p>for encoder errors (unlikely, probably a bug)</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-get_search_entry"><a href="#val-get_search_entry" class="anchor"></a><code><span class="keyword">val</span> get_search_entry : <a href="index.html#type-conn">conn</a> <span>&#45;&gt;</span> <a href="index.html#type-msgid">msgid</a> <span>&#45;&gt;</span> <span>[&gt; <span>`Entry of <a href="../Ldap_types/index.html#type-search_result_entry">Ldap_types.search_result_entry</a></span> <span><span>| `Referral</span> of <span>string list</span></span> ]</span></code></dt><dd><p>fetch a search entry from the wire using the given msgid. The entry could be a search entry, OR it could be a referral structure.</p><dl><dt>raises LDAP_Failure</dt><dd><p>for all results other than `SUCCESS (except referrals)</p></dd></dl><dl><dt>raises Decoding_error</dt><dd><p>for decoder errors (unlikely, probably a bug)</p></dd></dl><dl><dt>raises Encoding_error</dt><dd><p>for encoder errors (unlikely, probably a bug)</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-get_search_entry_with_controls"><a href="#val-get_search_entry_with_controls" class="anchor"></a><code><span class="keyword">val</span> get_search_entry_with_controls : <a href="index.html#type-conn">conn</a> <span>&#45;&gt;</span> <a href="index.html#type-msgid">msgid</a> <span>&#45;&gt;</span> <span>[&gt; <span>`Entry of <a href="../Ldap_types/index.html#type-search_result_entry">Ldap_types.search_result_entry</a></span> <span><span>| `Referral</span> of <span>string list</span></span> <span><span>| `Success</span> of <span><a href="../Ldap_types/index.html#type-ldap_controls">Ldap_types.ldap_controls</a> option</span></span> ]</span></code></dt><dd><p>fetch a search entry from the wire using the given msgid. The entry could be a search entry, OR it could be a referral structure.</p><p>The version supports passing ldap_controls (like page control) through on success. Returning an entry of type `SUCCESS was thus needed.</p><dl><dt>raises LDAP_Failure</dt><dd><p>for all results other than `SUCCESS (except referrals)</p></dd></dl><dl><dt>raises Decoding_error</dt><dd><p>for decoder errors (unlikely, probably a bug)</p></dd></dl><dl><dt>raises Encoding_error</dt><dd><p>for encoder errors (unlikely, probably a bug)</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-abandon"><a href="#val-abandon" class="anchor"></a><code><span class="keyword">val</span> abandon : <a href="index.html#type-conn">conn</a> <span>&#45;&gt;</span> <a href="index.html#type-msgid">msgid</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>abandon the async request attached to msgid.</p><dl><dt>raises Encoding_error</dt><dd><p>for encoder errors (unlikely, probably a bug)</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-search_s"><a href="#val-search_s" class="anchor"></a><code><span class="keyword">val</span> search_s : <span>?&#8288;base:string</span> <span>&#45;&gt;</span> <span>?&#8288;scope:<a href="../Ldap_types/index.html#type-search_scope">Ldap_types.search_scope</a></span> <span>&#45;&gt;</span> <span>?&#8288;aliasderef:<a href="../Ldap_types/index.html#type-alias_deref">Ldap_types.alias_deref</a></span> <span>&#45;&gt;</span> <span>?&#8288;sizelimit:int32</span> <span>&#45;&gt;</span> <span>?&#8288;timelimit:int32</span> <span>&#45;&gt;</span> <span>?&#8288;attrs:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;attrsonly:bool</span> <span>&#45;&gt;</span> <a href="index.html#type-conn">conn</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>[&gt; <span>`Entry of <a href="../Ldap_types/index.html#type-search_result_entry">Ldap_types.search_result_entry</a></span> <span><span>| `Referral</span> of <span>string list</span></span> ]</span> list</span></code></dt><dd><p>This is the syncronus version of search. It blocks until the search is complete, and returns a list of objects. It is exactly the same in all other ways.</p></dd></dl><dl><dt class="spec value" id="val-add_s"><a href="#val-add_s" class="anchor"></a><code><span class="keyword">val</span> add_s : <a href="index.html#type-conn">conn</a> <span>&#45;&gt;</span> <a href="index.html#type-entry">entry</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>add entry to the directory</p><dl><dt>raises LDAP_Failure</dt><dd><p>for all results other than `SUCCESS</p></dd></dl><dl><dt>raises Decoding_error</dt><dd><p>for decoder errors (unlikely, probably a bug)</p></dd></dl><dl><dt>raises Encoding_error</dt><dd><p>for encoder errors (unlikely, probably a bug)</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-delete_s"><a href="#val-delete_s" class="anchor"></a><code><span class="keyword">val</span> delete_s : <a href="index.html#type-conn">conn</a> <span>&#45;&gt;</span> <span>dn:string</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>delete the entry named by dn from the directory</p><dl><dt>raises LDAP_Failure</dt><dd><p>for all results other than `SUCCESS</p></dd></dl><dl><dt>raises Decoding_error</dt><dd><p>for decoder errors (unlikely, probably a bug)</p></dd></dl><dl><dt>raises Encoding_error</dt><dd><p>for encoder errors (unlikely, probably a bug)</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-modify_s"><a href="#val-modify_s" class="anchor"></a><code><span class="keyword">val</span> modify_s : <a href="index.html#type-conn">conn</a> <span>&#45;&gt;</span> <span>dn:string</span> <span>&#45;&gt;</span> <span>mods:<span><span>(<a href="../Ldap_types/index.html#type-modify_optype">Ldap_types.modify_optype</a> * string * <span>string list</span>)</span> list</span></span> <span>&#45;&gt;</span> unit</code></dt><dd><p>apply the list of modifications to the named entry</p><dl><dt>parameter dn</dt><dd><p>The dn of the object to modify</p></dd></dl><dl><dt>parameter mods</dt><dd><p>The list of modifications to apply</p></dd></dl><dl><dt>raises LDAP_Failure</dt><dd><p>for all results other than `SUCCESS</p></dd></dl><dl><dt>raises Decoding_error</dt><dd><p>for decoder errors (unlikely, probably a bug)</p></dd></dl><dl><dt>raises Encoding_error</dt><dd><p>for encoder errors (unlikely, probably a bug)</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-modrdn_s"><a href="#val-modrdn_s" class="anchor"></a><code><span class="keyword">val</span> modrdn_s : <span>?&#8288;deleteoldrdn:bool</span> <span>&#45;&gt;</span> <span>?&#8288;newsup:<span><span class="type-var">'a</span> option</span></span> <span>&#45;&gt;</span> <a href="index.html#type-conn">conn</a> <span>&#45;&gt;</span> <span>dn:string</span> <span>&#45;&gt;</span> <span>newdn:string</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>change the rdn, and optionally the superior entry of dn</p><dl><dt>parameter deleteoldrdn</dt><dd><p>Delete the old rdn value, (default true)</p></dd></dl><dl><dt>parameter newsup</dt><dd><p>The new superior dn of the object (default None)</p></dd></dl><dl><dt>parameter dn</dt><dd><p>The dn of the object to modify</p></dd></dl><dl><dt>parameter newrdn</dt><dd><p>The new rdn value (eg. cn=bob)</p></dd></dl><dl><dt>raises LDAP_Failure</dt><dd><p>for all results other than `SUCCESS</p></dd></dl><dl><dt>raises Decoding_error</dt><dd><p>for decoder errors (unlikely, probably a bug)</p></dd></dl><dl><dt>raises Encoding_error</dt><dd><p>for encoder errors (unlikely, probably a bug)</p></dd></dl></dd></dl></div></body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>ldapcon (ldap.Ldap_ooclient.ldapcon)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">ldap</a> &#x00BB; <a href="../index.html">Ldap_ooclient</a> &#x00BB; ldapcon</nav><h1>Class <code>Ldap_ooclient.ldapcon</code></h1><p>This class abstracts a connection to an LDAP server (or servers), an instance will be connected to the server you specify and can be used to perform operations on that server.</p><h3 id="example"><a href="#example" class="anchor"></a>Example</h3><p><code>new ldapcon ~connect_timeout:5 ~version:3
    [&quot;ldap://first.ldap.server&quot;;&quot;ldap://second.ldap.server&quot;]</code>.</p><p>In addition to specifying multiple urls, if DNS names are given, and those names are bound to multiple addresses, then all possible addresses will be tried.</p><h3 id="example"><a href="#example" class="anchor"></a>Example</h3><p><code>new ldapcon [&quot;ldaps://rrldap.csun.edu&quot;]</code></p><p>is equivelant to</p><p><code>new ldapcon [&quot;ldap://130.166.1.30&quot;;&quot;ldap://130.166.1.31&quot;;&quot;ldap://130.166.1.32&quot;]</code></p><p>This means that if any host in the rr fails, the ldapcon will transparently move on to the next host, and you will never know the difference.</p><dl><dt>raises LDAP_Failure</dt><dd><p>All methods raise <a href="../../Ldap_types/index.html#exception-LDAP_Failure"><code>Ldap_types.LDAP_Failure</code></a> on error</p></dd></dl><dl><dt>parameter connect_timeout</dt><dd><p>Default <code>1</code>, an integer which specifies how long to wait for any given server in the list to respond before trying the next one. After all the servers have been tried for <code>connect_timeout</code> seconds <code>LDAP_Failure (`SERVER_DOWN, ...)</code> will be raised.</p></dd></dl><dl><dt>parameter referral_policy</dt><dd><p>In a future version of ocamldap this will be used to specify what you would like to do in the event of a referral. Currently it does nothing and is ignored see <a href="../index.html#type-referral_policy"><code>Ldap_ooclient.referral_policy</code></a>.</p></dd></dl><dl><dt>parameter version</dt><dd><p>The protocol version to use, the default is <code>3</code>, the other recognized value is <code>2</code>.</p></dd></dl><nav class="toc"><ul><li><a href="#authentication">Authentication</a></li><li><a href="#searching">Searching</a></li><li><a href="#making-modifications">Making Modifications</a></li></ul></nav></header><section><header><h2 id="authentication"><a href="#authentication" class="anchor"></a>Authentication</h2></header><dl><dt class="spec method" id="method-bind"><a href="#method-bind" class="anchor"></a><code><span class="keyword">method</span> bind : <span>?&#8288;cred:string</span> <span>&#45;&gt;</span> <span>?&#8288;meth:<a href="../../Ldap_funclient/index.html#type-authmethod">Ldap_funclient.authmethod</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>bind to the database using dn.</p><h3 id="simple-bind-example"><a href="#simple-bind-example" class="anchor"></a>Simple Bind Example</h3><p><code>ldap#bind ~cred:&quot;password&quot; &quot;cn=foo,ou=people,ou=auth,o=bar&quot;</code></p><p>To bind anonymously, omit ~cred, and leave dn blank eg.</p><h3 id="example"><a href="#example" class="anchor"></a>Example</h3><p><code>ldap#bind &quot;&quot;</code></p><dl><dt>parameter cred</dt><dd><p>The credentials to provide for binding. Default <code>&quot;&quot;</code>.</p></dd></dl><dl><dt>parameter meth</dt><dd><p>The method to use when binding See <a href="../../Ldap_funclient/index.html#type-authmethod"><code>Ldap_funclient.authmethod</code></a> the default is <code>`SIMPLE</code>. If <code>`SASL</code> is used then <code>dn</code> and <code>~cred</code> Are interperted according to the chosen SASL mechanism. SASL binds have not been tested extensively.</p></dd></dl></dd></dl><dl><dt class="spec method" id="method-unbind"><a href="#method-unbind" class="anchor"></a><code><span class="keyword">method</span> unbind : unit</code></dt><dd><p>Deauthenticate and close the connection to the server</p></dd></dl></section><section><header><h2 id="searching"><a href="#searching" class="anchor"></a>Searching</h2></header><dl><dt class="spec method" id="method-search"><a href="#method-search" class="anchor"></a><code><span class="keyword">method</span> search : <span>?&#8288;scope:<a href="../../Ldap_types/index.html#type-search_scope">Ldap_types.search_scope</a></span> <span>&#45;&gt;</span> <span>?&#8288;attrs:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;attrsonly:bool</span> <span>&#45;&gt;</span> <span>?&#8288;base:string</span> <span>&#45;&gt;</span> <span>?&#8288;sizelimit:Stdlib.Int32.t</span> <span>&#45;&gt;</span> <span>?&#8288;timelimit:Stdlib.Int32.t</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><a href="../class-ldapentry/index.html">ldapentry</a> list</span></code></dt><dd><p>Search the directory syncronously for an entry which matches the search criteria.</p><h3 id="example"><a href="#example" class="anchor"></a>Example</h3><p><code>ldap#search ~base:&quot;dc=foo,dc=bar&quot; ~attrs:[&quot;cn&quot;] &quot;uid=*&quot;</code></p><dl><dt>parameter scope</dt><dd><p>Default <code>`SUBTREE</code>, defines the scope of the search. see <a href="../../Ldap_types/index.html#type-search_scope"><code>Ldap_types.search_scope</code></a></p></dd></dl><dl><dt>parameter attrs</dt><dd><p>Default <code>[]</code> (means all attributes)</p></dd></dl><dl><dt>parameter attrsonly</dt><dd><p>Default <code>false</code> If true, asks the server to return only the attribute names, not their values.</p></dd></dl><dl><dt>parameter base</dt><dd><p>Default <code>&quot;&quot;</code>, The search base, which is the dn of the object from which you want to start your search. Only that object, and it's children will be included in the search. Further controlled by <code>~scope</code>.</p></dd></dl><dl><dt>parameter timelimit</dt><dd><p>The time limit (in seconds) to allow the search to run for. Default <code>0l</code>, which means there is no user specified time limit, the server may still impose one.</p></dd></dl><dl><dt>parameter sizelimit</dt><dd><p>The max number of entries to return from the search (in number of entries)</p></dd></dl></dd></dl><dl><dt class="spec method" id="method-search_a"><a href="#method-search_a" class="anchor"></a><code><span class="keyword">method</span> search_a : <span>?&#8288;scope:<a href="../../Ldap_types/index.html#type-search_scope">Ldap_types.search_scope</a></span> <span>&#45;&gt;</span> <span>?&#8288;attrs:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;attrsonly:bool</span> <span>&#45;&gt;</span> <span>?&#8288;base:string</span> <span>&#45;&gt;</span> <span>?&#8288;sizelimit:Stdlib.Int32.t</span> <span>&#45;&gt;</span> <span>?&#8288;timelimit:Stdlib.Int32.t</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>?&#8288;abandon:bool</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="../class-ldapentry/index.html">ldapentry</a></code></dt><dd><p>Search the directory asyncronously, otherwise the same as search.</p></dd></dl><dl><dt class="spec method" id="method-rawschema"><a href="#method-rawschema" class="anchor"></a><code><span class="keyword">method</span> rawschema : <a href="../class-ldapentry/index.html">ldapentry</a></code></dt><dd><p>Fetch the raw (unparsed) schema from the directory using the standard mechanism (requires protocol version 3)</p></dd></dl><dl><dt class="spec method" id="method-schema"><a href="#method-schema" class="anchor"></a><code><span class="keyword">method</span> schema : <a href="../../Ldap_schemaparser/index.html#type-schema">Ldap_schemaparser.schema</a></code></dt><dd><p>Fetch and parse the schema from the directory via the standard mechanism (requires version 3). Return a structured representation of the schema indexed by canonical name, and oid.</p></dd></dl></section><section><header><h2 id="making-modifications"><a href="#making-modifications" class="anchor"></a>Making Modifications</h2></header><dl><dt class="spec method" id="method-add"><a href="#method-add" class="anchor"></a><code><span class="keyword">method</span> add : <a href="../class-ldapentry/index.html">ldapentry</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>add an entry to the database</p></dd></dl><dl><dt class="spec method" id="method-delete"><a href="#method-delete" class="anchor"></a><code><span class="keyword">method</span> delete : string <span>&#45;&gt;</span> unit</code></dt><dd><p>Delete the object named by dn from the database</p></dd></dl><dl><dt class="spec method" id="method-modify"><a href="#method-modify" class="anchor"></a><code><span class="keyword">method</span> modify : string <span>&#45;&gt;</span> <span><span>(<a href="../../Ldap_types/index.html#type-modify_optype">Ldap_types.modify_optype</a> * string * <span>string list</span>)</span> list</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Modify the entry named by dn, applying mods</p><h3 id="example"><a href="#example" class="anchor"></a>Example</h3><p><code>ldap#modify &quot;uid=foo,ou=people,dc=bar,dc=baz&quot; [(`DELETE, &quot;cn&quot;, [&quot;foo&quot;;&quot;bar&quot;])]</code></p></dd></dl><dl><dt class="spec method" id="method-update_entry"><a href="#method-update_entry" class="anchor"></a><code><span class="keyword">method</span> update_entry : <a href="../class-ldapentry/index.html">ldapentry</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Syncronize changes made locally to an ldapentry with the directory.</p></dd></dl><dl><dt class="spec method" id="method-modrdn"><a href="#method-modrdn" class="anchor"></a><code><span class="keyword">method</span> modrdn : string <span>&#45;&gt;</span> <span>?&#8288;deleteoldrdn:bool</span> <span>&#45;&gt;</span> <span>?&#8288;newsup:<span>string option</span></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>Modify the rdn of the object named by dn, if the protocol version is 3 you may additionally change the superior, the rdn will be changed to the attribute represented (as a string) by newrdn,</p><h3 id="example-with-new-superior"><a href="#example-with-new-superior" class="anchor"></a>Example With New Superior</h3><p><code>ldap#modrdn ~newsup:(Some &quot;o=csun&quot;) &quot;cn=bob,ou=people,o=org&quot; &quot;uid=bperson&quot;</code></p><p>After this example &quot;cn=bob,ou=people,o=org&quot; will end up as &quot;uid=bperson,o=csun&quot;.</p><dl><dt>parameter deleteoldrdn</dt><dd><p>Default <code>true</code>, delete the old rdn value as part of the modrdn.</p></dd></dl><dl><dt>parameter newsup</dt><dd><p>Default <code>None</code>, only valid when the protocol version is 3, change the object's location in the tree, making its superior equal to the specified object.</p></dd></dl></dd></dl></section></div></body></html>
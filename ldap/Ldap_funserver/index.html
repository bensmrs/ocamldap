<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Ldap_funserver (ldap.Ldap_funserver)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">ldap</a> &#x00BB; Ldap_funserver</nav><h1>Module <code>Ldap_funserver</code></h1><p>A functional ldap server construction kit</p></header><dl><dt class="spec exception" id="exception-Server_error"><a href="#exception-Server_error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Server_error</span> <span class="keyword">of</span> string</code></dt><dd><p>raised whenever an error occurrs in the server</p></dd></dl><dl><dt class="spec type" id="type-connection_id"><a href="#type-connection_id" class="anchor"></a><code><span class="keyword">type</span> connection_id</code><code> = int</code></dt><dt class="spec type" id="type-backendInfo"><a href="#type-backendInfo" class="anchor"></a><code><span class="keyword">type</span> backendInfo</code><code> = </code><code>{</code><table class="record"><tr id="type-backendInfo.bi_op_bind" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_op_bind" class="anchor"></a><code>bi_op_bind : <span><span>(<a href="index.html#type-connection_id">connection_id</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a>)</span> option</span>;</code></td></tr><tr id="type-backendInfo.bi_op_unbind" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_op_unbind" class="anchor"></a><code>bi_op_unbind : <span><span>(<a href="index.html#type-connection_id">connection_id</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a> <span>&#45;&gt;</span> unit)</span> option</span>;</code></td></tr><tr id="type-backendInfo.bi_op_search" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_op_search" class="anchor"></a><code>bi_op_search : <span><span>(<a href="index.html#type-connection_id">connection_id</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a>)</span> option</span>;</code></td></tr><tr id="type-backendInfo.bi_op_compare" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_op_compare" class="anchor"></a><code>bi_op_compare : <span><span>(<a href="index.html#type-connection_id">connection_id</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a>)</span> option</span>;</code></td></tr><tr id="type-backendInfo.bi_op_modify" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_op_modify" class="anchor"></a><code>bi_op_modify : <span><span>(<a href="index.html#type-connection_id">connection_id</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a>)</span> option</span>;</code></td></tr><tr id="type-backendInfo.bi_op_modrdn" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_op_modrdn" class="anchor"></a><code>bi_op_modrdn : <span><span>(<a href="index.html#type-connection_id">connection_id</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a>)</span> option</span>;</code></td></tr><tr id="type-backendInfo.bi_op_add" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_op_add" class="anchor"></a><code>bi_op_add : <span><span>(<a href="index.html#type-connection_id">connection_id</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a>)</span> option</span>;</code></td></tr><tr id="type-backendInfo.bi_op_delete" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_op_delete" class="anchor"></a><code>bi_op_delete : <span><span>(<a href="index.html#type-connection_id">connection_id</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a>)</span> option</span>;</code></td></tr><tr id="type-backendInfo.bi_op_abandon" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_op_abandon" class="anchor"></a><code>bi_op_abandon : <span><span>(<a href="index.html#type-connection_id">connection_id</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a> <span>&#45;&gt;</span> unit)</span> option</span>;</code></td></tr><tr id="type-backendInfo.bi_op_extended" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_op_extended" class="anchor"></a><code>bi_op_extended : <span><span>(<a href="index.html#type-connection_id">connection_id</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a> <span>&#45;&gt;</span> <a href="../Ldap_types/index.html#type-ldap_message">Ldap_types.ldap_message</a>)</span> option</span>;</code></td></tr><tr id="type-backendInfo.bi_init" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_init" class="anchor"></a><code>bi_init : <span><span>(unit <span>&#45;&gt;</span> unit)</span> option</span>;</code></td></tr><tr id="type-backendInfo.bi_close" class="anchored"><td class="def field"><a href="#type-backendInfo.bi_close" class="anchor"></a><code>bi_close : <span><span>(unit <span>&#45;&gt;</span> unit)</span> option</span>;</code></td></tr></table><code>}</code></dt><dd><p>This structure is the guts of the ldap server. For each operation that you implement put the function (or closure) of the correct type in this structure. Any functions you set as None will return `UNWILLING_TO_PERFORM, with the error string set to &quot;not implemented&quot;. bi_init will be called (if it is provided) before the server is brought up, and bi_close (if it is provided) will be called before the server is brought down. This interface is based loosely on the back-end api in OpenLDAP.</p></dd></dl><dl><dt class="spec type" id="type-log_level"><a href="#type-log_level" class="anchor"></a><code><span class="keyword">type</span> log_level</code> = <code>[ </code><table class="variant"><tr id="type-log_level.GENERAL" class="anchored"><td class="def constructor"><a href="#type-log_level.GENERAL" class="anchor"></a><code>| </code><code>`GENERAL</code></td></tr><tr id="type-log_level.CONNECTION" class="anchored"><td class="def constructor"><a href="#type-log_level.CONNECTION" class="anchor"></a><code>| </code><code>`CONNECTION</code></td></tr><tr id="type-log_level.OPERATIONS" class="anchored"><td class="def constructor"><a href="#type-log_level.OPERATIONS" class="anchor"></a><code>| </code><code>`OPERATIONS</code></td></tr><tr id="type-log_level.ERROR" class="anchored"><td class="def constructor"><a href="#type-log_level.ERROR" class="anchor"></a><code>| </code><code>`ERROR</code></td></tr><tr id="type-log_level.TRACE" class="anchored"><td class="def constructor"><a href="#type-log_level.TRACE" class="anchor"></a><code>| </code><code>`TRACE</code></td></tr></table><code> ]</code></dt></dl><aside><p>This abstract type contains the server context. It has the listening, socket, all the connected client sockets, and some internal data structures.</p></aside><dl><dt class="spec type" id="type-server_info"><a href="#type-server_info" class="anchor"></a><code><span class="keyword">type</span> server_info</code></dt></dl><dl><dt class="spec value" id="val-init"><a href="#val-init" class="anchor"></a><code><span class="keyword">val</span> init : <span>?&#8288;log:<span>(<a href="index.html#type-log_level">log_level</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit)</span></span> <span>&#45;&gt;</span> <span>?&#8288;port:int</span> <span>&#45;&gt;</span> <a href="index.html#type-backendInfo">backendInfo</a> <span>&#45;&gt;</span> <a href="index.html#type-server_info">server_info</a></code></dt><dd><p>Initialize the server, create the listening socket and return the server context, which you will pass to serv to process connections. log is a string -&gt; log_level -&gt; unit function to which log messages will be sent.</p></dd></dl><dl><dt class="spec value" id="val-shutdown"><a href="#val-shutdown" class="anchor"></a><code><span class="keyword">val</span> shutdown : <a href="index.html#type-server_info">server_info</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Shutdown the server</p></dd></dl><dl><dt class="spec value" id="val-run"><a href="#val-run" class="anchor"></a><code><span class="keyword">val</span> run : <a href="index.html#type-server_info">server_info</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Using the supplied server context, begin processing ldap operations. This function should never terminate unless there is an exceptional condition, in which case the exception will be raised. In many cases it is safe to restart the server process when an exception happens.</p></dd></dl></div></body></html>